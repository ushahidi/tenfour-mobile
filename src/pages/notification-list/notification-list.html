<ion-header>
  <ion-navbar color="navbar">
    <ion-buttons left *ngIf="modal == true">
      <button ion-button color="cancel" (click)="close($event)">Close</button>
    </ion-buttons>
    <ion-title>Notifications</ion-title>
  </ion-navbar>
</ion-header>
<ion-content>
  <ion-refresher (ionRefresh)="loadUpdates(false, $event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <div text-center class="spinner" *ngIf="loading == true && (notifications == null || notifications.length == 0)">
    <ion-spinner name="ios"></ion-spinner>
  </div>
  <ion-list *ngIf="notifications">
    <ion-item no-lines *ngIf="loading == false && notifications.length == 0">
      <h2>There currently are no notifications...</h2>
    </ion-item>
    <ion-card color="card" [class.viewed]="notification.viewed_at" *ngFor="let notification of notifications">
      <ion-card-content text-wrap *ngIf="notification.type == 'Welcome'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>Welcome to TenFour!</h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'WelcomeAbandoned'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>Welcome to TenFour.</h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'PersonJoinedOrganization'">
        <person-avatar float-left margin-right [initials]="notification.person_initials" [image]="notification.person_picture" [large]="false"></person-avatar>
        <h2>
          <strong>{{notification.person_name}}</strong> joined the organization.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'PersonLeftOrganization'">
        <person-avatar float-left margin-right [initials]="notification.person_initials" [image]="notification.person_picture" [large]="false"></person-avatar>
        <h2>
          <strong>{{notification.person_name}}</strong> left the organization.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'PersonToPerson'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>
          <strong>{{notification.person_name}}</strong> sent you a notification:
          <em>{{notification.message}}</em>
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'CheckInReceived'">
        <person-avatar float-left margin-right [initials]="notification.person_initials" [image]="notification.person_picture" [large]="false"></person-avatar>
        <h2>
          You received a Check-In <strong *ngIf="notification.checkin_message">{{notification.checkin_message}}</strong>.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'ReplyReceived'">
        <person-avatar float-left margin-right [initials]="notification.person_initials" [image]="notification.person_picture" [large]="false"></person-avatar>
        <h2>
          <strong>{{notification.reply_from}}</strong> responded to a Check-In.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'ImportSucceeded'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>
          <strong>
            <span *ngIf="notification.import_count == 0">Nobody was imported</span>
            <span *ngIf="notification.import_count == 1">1 person was imported</span>
            <span *ngIf="notification.import_count > 1">{{notification.import_count}} people were imported</span>
          </strong> into the organization.
          <span *ngIf="notification.import_dupe_count == 1">1 duplicate was found.</span>
          <span *ngIf="notification.import_dupe_count > 1">{{notification.import_dupe_count}} duplicates were found.</span>
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'ImportFailed'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>
          <strong>Import failed</strong> {{notification.message}}
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'Unsubscribe'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>
          <strong>{{notification.person_name}}</strong> blocked the {{notification.contact_type}} <strong>{{notification.contact}}</strong> from receiving Check-Ins.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'Complaint'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>
          <strong>{{notification.person_name}}</strong> reported the TenFour <strong>{{notification.checkin_message}}</strong> as spam.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'FreePromoEnding'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>{{notification.message}}</h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'TrialEnding'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>{{notification.message}}</h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'PaymentSucceeded'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>
          <strong>Successful Payment</strong> to TenFour on the {{notification.card_type}} card ending in {{notification.card_last_four}}.
          We have added {{notification.card_adjustment}} credits to your account.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
      <ion-card-content text-wrap *ngIf="notification.type == 'PaymentFailed'">
        <organization-logo float-left margin-right [image]="organization.profile_picture"></organization-logo>
        <h2>
          <strong>Payment Failure</strong> on the {{notification.card_type}} card ending in {{notification.card_last_four}}.
        </h2>
        <p>{{notification.created_at | dateTime}}</p>
      </ion-card-content>
    </ion-card>
  </ion-list>
  <ion-infinite-scroll *ngIf="mobile == true" (ionInfinite)="loadMore($event)">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
